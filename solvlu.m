%solving Ax=b using lu decomposition
tic

A=[1 1 1;6 -4 5;5 2 2];
b=[2; 31; 13];

%upper

a1=A(2,1)/A(1,1);
A(2,:) = A(2,:) - (A(2,1)/A(1,1))*A(1,:);


a2=A(3,1)/A(1,1);
A(3,:) = A(3,:) - (A(3,1)/A(1,1))*A(1,:);

a3=A(3,2)/A(2,2);

A(3,:) = A(3,:) - (A(3,2)/A(2,2))*A(2,:);


%lower

B=[1 0 0 ;a1 1 0 ; a2 a3  1];



y=zeros(3,1);
y(1)=b(1,1)/B(1,1);
y(2)=(b(2,1)-B(2,1)*y(1))/B(2,2);
y(3)=(b(3,1)-B(3,1)*y(1)-B(3,2)*y(2))/B(3,3);

z=zeros(3,1);
z(3)=y(3,1)/A(3,3);
z(2)=(y(2,1) - A(2,3)*z(3))/A(2,2);
z(1)=(y(1,1) - A(1,2)*z(2) - A(1,3)*z(3))/A(1,1);

disp('Roots via LU decompostion are :')
disp(z)

toc